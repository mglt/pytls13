[2022-08-02 14:25:14,437 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-02 14:25:14,438 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-02 14:26:36,215 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-02 14:26:36,216 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-02 15:23:28,177 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-02 15:23:28,178 : cs.py:80 -                serve() ] 'handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1899, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1816, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1552, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
KeyError: 'handshake'
[2022-08-03 08:36:11,643 : cs.py:75 -                serve() ] ('invalid_session_id', 'Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 4074545569985010216\n    payload = Container: \n        session_id = b\'j\\xa4\\xb8\\xf2\' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b\'\\x03\\x03\' (total 2)\n                    random = b"\\xd2E\\x1cD\\xc5\\xd7\\x8dV\\xc7SM&\\xd2#\'d"... (truncated, total 32)\n                    legacy_session_id_echo = b\'\\xb05\\xb7K\\xc5%n0\\xe7\\xad&\\xc5\\xe6\\xcc\\xa0/\'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b\'\\x13\\x03\'\n                    legacy_compression_method = b\'\\x00\' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b\'\\x03\\x04\' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b\'\\x00\\x1d\'\n                                    key_exchange = b\'\\xde\\x0e\\x96>\\r\\x8d\\x89\\xbe\\xd1\\xce?\\x882 o4\'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b\'\' (total 0) session_id not found in DB') - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 4074545569985010216
    payload = Container: 
        session_id = b'j\xa4\xb8\xf2' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b"\xd2E\x1cD\xc5\xd7\x8dV\xc7SM&\xd2#'d"... (truncated, total 32)
                    legacy_session_id_echo = b'\xb05\xb7K\xc5%n0\xe7\xad&\xc5\xe6\xcc\xa0/'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xde\x0e\x96>\r\x8d\x89\xbe\xd1\xce?\x882 o4'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 08:36:11,644 : cs.py:75 -                serve() ] ('invalid_session_id', 'Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 4074545569985010216\n    payload = Container: \n        session_id = b\'j\\xa4\\xb8\\xf2\' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b\'\\x03\\x03\' (total 2)\n                    random = b"\\xd2E\\x1cD\\xc5\\xd7\\x8dV\\xc7SM&\\xd2#\'d"... (truncated, total 32)\n                    legacy_session_id_echo = b\'\\xb05\\xb7K\\xc5%n0\\xe7\\xad&\\xc5\\xe6\\xcc\\xa0/\'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b\'\\x13\\x03\'\n                    legacy_compression_method = b\'\\x00\' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b\'\\x03\\x04\' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b\'\\x00\\x1d\'\n                                    key_exchange = b\'\\xde\\x0e\\x96>\\r\\x8d\\x89\\xbe\\xd1\\xce?\\x882 o4\'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b\'\' (total 0) session_id not found in DB') - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 4074545569985010216
    payload = Container: 
        session_id = b'j\xa4\xb8\xf2' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b"\xd2E\x1cD\xc5\xd7\x8dV\xc7SM&\xd2#'d"... (truncated, total 32)
                    legacy_session_id_echo = b'\xb05\xb7K\xc5%n0\xe7\xad&\xc5\xe6\xcc\xa0/'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xde\x0e\x96>\r\x8d\x89\xbe\xd1\xce?\x882 o4'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 08:58:24,749 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 11041028433577280100\n    payload = Container: \n        session_id = b'SR\\xab\\x88' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\t/\\r\\x13\\xf9\\xf9k\\xa1\\xbf\\x98\\x92\\xd2d\\x98J!'... (truncated, total 32)\n                    legacy_session_id_echo = b'i5c\\xb4K.\\xd9\\xb9\\xed@0\\xd6\\x83\\x1a\\x1c\\xe7'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'x\\xb8\\xbe\\xd4S3\\\\\\xb2\\xdd{\\x95eR\\xf8\\x82\\xab'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 11041028433577280100
    payload = Container: 
        session_id = b'SR\xab\x88' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\t/\r\x13\xf9\xf9k\xa1\xbf\x98\x92\xd2d\x98J!'... (truncated, total 32)
                    legacy_session_id_echo = b'i5c\xb4K.\xd9\xb9\xed@0\xd6\x83\x1a\x1c\xe7'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'x\xb8\xbe\xd4S3\\\xb2\xdd{\x95eR\xf8\x82\xab'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 08:58:24,750 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 11041028433577280100\n    payload = Container: \n        session_id = b'SR\\xab\\x88' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\t/\\r\\x13\\xf9\\xf9k\\xa1\\xbf\\x98\\x92\\xd2d\\x98J!'... (truncated, total 32)\n                    legacy_session_id_echo = b'i5c\\xb4K.\\xd9\\xb9\\xed@0\\xd6\\x83\\x1a\\x1c\\xe7'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'x\\xb8\\xbe\\xd4S3\\\\\\xb2\\xdd{\\x95eR\\xf8\\x82\\xab'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 11041028433577280100
    payload = Container: 
        session_id = b'SR\xab\x88' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\t/\r\x13\xf9\xf9k\xa1\xbf\x98\x92\xd2d\x98J!'... (truncated, total 32)
                    legacy_session_id_echo = b'i5c\xb4K.\xd9\xb9\xed@0\xd6\x83\x1a\x1c\xe7'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'x\xb8\xbe\xd4S3\\\xb2\xdd{\x95eR\xf8\x82\xab'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:12:47,433 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 3699894740475551815\n    payload = Container: \n        session_id = b'\\xb6\\xf6*\\t' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\xa4\\x08\\n\\x9b\\x8425\\x81\\xe1@\\x847\\xc5\\xb9\\xc8S'... (truncated, total 32)\n                    legacy_session_id_echo = b'Si\\xec\\xe4\\x0e\\xb0\\x0f\\xb5\\x15\\xa40\\x1f\\x9bt\\x93^'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'\\xdc6\\x01\\xca\\x9dF\\x91\\xab\\xa7\\xa0\\xbe\\xeb\\x17\\xb9\\xc6X'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 3699894740475551815
    payload = Container: 
        session_id = b'\xb6\xf6*\t' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\xa4\x08\n\x9b\x8425\x81\xe1@\x847\xc5\xb9\xc8S'... (truncated, total 32)
                    legacy_session_id_echo = b'Si\xec\xe4\x0e\xb0\x0f\xb5\x15\xa40\x1f\x9bt\x93^'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xdc6\x01\xca\x9dF\x91\xab\xa7\xa0\xbe\xeb\x17\xb9\xc6X'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:12:47,434 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 3699894740475551815\n    payload = Container: \n        session_id = b'\\xb6\\xf6*\\t' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\xa4\\x08\\n\\x9b\\x8425\\x81\\xe1@\\x847\\xc5\\xb9\\xc8S'... (truncated, total 32)\n                    legacy_session_id_echo = b'Si\\xec\\xe4\\x0e\\xb0\\x0f\\xb5\\x15\\xa40\\x1f\\x9bt\\x93^'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'\\xdc6\\x01\\xca\\x9dF\\x91\\xab\\xa7\\xa0\\xbe\\xeb\\x17\\xb9\\xc6X'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 3699894740475551815
    payload = Container: 
        session_id = b'\xb6\xf6*\t' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\xa4\x08\n\x9b\x8425\x81\xe1@\x847\xc5\xb9\xc8S'... (truncated, total 32)
                    legacy_session_id_echo = b'Si\xec\xe4\x0e\xb0\x0f\xb5\x15\xa40\x1f\x9bt\x93^'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xdc6\x01\xca\x9dF\x91\xab\xa7\xa0\xbe\xeb\x17\xb9\xc6X'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:14:13,280 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 11414933227388120568\n    payload = Container: \n        session_id = b'\\xc2\\xbfos' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\xda\\x05\\xad8cE\\xe4[\\x9f\\xcet\\x8d\\x0c\\xa7<f'... (truncated, total 32)\n                    legacy_session_id_echo = b'\\xf0\\x96\\x1b\\xe0?\\xf6T-\\xdf\\xa2\\xd4t\\xba\\x12\\x8f\\xf6'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'\\xed\\xd9[\\xc7\\xd8N\\x00\\xe6\\xe9\\xff\\x17\\xa3\\xfaW\\x9b\\xf1'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 11414933227388120568
    payload = Container: 
        session_id = b'\xc2\xbfos' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\xda\x05\xad8cE\xe4[\x9f\xcet\x8d\x0c\xa7<f'... (truncated, total 32)
                    legacy_session_id_echo = b'\xf0\x96\x1b\xe0?\xf6T-\xdf\xa2\xd4t\xba\x12\x8f\xf6'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xed\xd9[\xc7\xd8N\x00\xe6\xe9\xff\x17\xa3\xfaW\x9b\xf1'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:14:13,281 : cs.py:75 -                serve() ] ('invalid_session_id', "Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 11414933227388120568\n    payload = Container: \n        session_id = b'\\xc2\\xbfos' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b'\\x03\\x03' (total 2)\n                    random = b'\\xda\\x05\\xad8cE\\xe4[\\x9f\\xcet\\x8d\\x0c\\xa7<f'... (truncated, total 32)\n                    legacy_session_id_echo = b'\\xf0\\x96\\x1b\\xe0?\\xf6T-\\xdf\\xa2\\xd4t\\xba\\x12\\x8f\\xf6'... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\\x13\\x03'\n                    legacy_compression_method = b'\\x00' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b'\\x03\\x04' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b'\\x00\\x1d'\n                                    key_exchange = b'\\xed\\xd9[\\xc7\\xd8N\\x00\\xe6\\xe9\\xff\\x17\\xa3\\xfaW\\x9b\\xf1'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b'' (total 0) session_id not found in DB") - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 11414933227388120568
    payload = Container: 
        session_id = b'\xc2\xbfos' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'\xda\x05\xad8cE\xe4[\x9f\xcet\x8d\x0c\xa7<f'... (truncated, total 32)
                    legacy_session_id_echo = b'\xf0\x96\x1b\xe0?\xf6T-\xdf\xa2\xd4t\xba\x12\x8f\xf6'... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xed\xd9[\xc7\xd8N\x00\xe6\xe9\xff\x17\xa3\xfaW\x9b\xf1'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:31:23,862 : cs.py:80 -                serve() ] 'Tls13Ext' object has no attribute 'db'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1906, in payload_resp
    print( f" --- sessionDB: {self.db }" )
AttributeError: 'Tls13Ext' object has no attribute 'db'
[2022-08-03 09:31:23,865 : cs.py:80 -                serve() ] 'Tls13Ext' object has no attribute 'db'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1906, in payload_resp
    print( f" --- sessionDB: {self.db }" )
AttributeError: 'Tls13Ext' object has no attribute 'db'
[2022-08-03 09:34:26,983 : cs.py:80 -                serve() ] 'Tls13Ext' object has no attribute 'db'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1906, in payload_resp
    print( f" --- sessionDB: {self.db }" )
AttributeError: 'Tls13Ext' object has no attribute 'db'
[2022-08-03 09:34:26,985 : cs.py:80 -                serve() ] 'Tls13Ext' object has no attribute 'db'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1906, in payload_resp
    print( f" --- sessionDB: {self.db }" )
AttributeError: 'Tls13Ext' object has no attribute 'db'
[2022-08-03 09:36:20,220 : cs.py:75 -                serve() ] ('invalid_session_id', 'Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 4556363251079193579\n    payload = Container: \n        session_id = b\'T7\\xdf\\xd2\' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b\'\\x03\\x03\' (total 2)\n                    random = b\'l\\xec\\x98\\xc3\\x0c\\xcc\\x16\\xedBE\\xfd(\\xcf]\\x13\\x99\'... (truncated, total 32)\n                    legacy_session_id_echo = b"\\xa7\\xcd\\xdf0\\x1f\\x06\\x04\\xab\\x0fU\\xebo<\'j\\x03"... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b\'\\x13\\x03\'\n                    legacy_compression_method = b\'\\x00\' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b\'\\x03\\x04\' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b\'\\x00\\x1d\'\n                                    key_exchange = b\'\\xa50\\xf8\\xe4\\x9a\\xb8\\xebH\\xd4^\\xfb\\xbe/\\x0f>\\x10\'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b\'\' (total 0) session_id not found in DB') - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 4556363251079193579
    payload = Container: 
        session_id = b'T7\xdf\xd2' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'l\xec\x98\xc3\x0c\xcc\x16\xedBE\xfd(\xcf]\x13\x99'... (truncated, total 32)
                    legacy_session_id_echo = b"\xa7\xcd\xdf0\x1f\x06\x04\xab\x0fU\xebo<'j\x03"... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xa50\xf8\xe4\x9a\xb8\xebH\xd4^\xfb\xbe/\x0f>\x10'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:36:20,222 : cs.py:75 -                serve() ] ('invalid_session_id', 'Container: \n    designation = (enum) tls13 2\n    version = (enum) v1 1\n    type = (enum) c_server_hello 10\n    status = (enum) request 0\n    id = 4556363251079193579\n    payload = Container: \n        session_id = b\'T7\\xdf\\xd2\' (total 4)\n        handshake = ListContainer: \n            Container: \n                msg_type = (enum) server_hello 2\n                data = Container: \n                    legacy_version = b\'\\x03\\x03\' (total 2)\n                    random = b\'l\\xec\\x98\\xc3\\x0c\\xcc\\x16\\xedBE\\xfd(\\xcf]\\x13\\x99\'... (truncated, total 32)\n                    legacy_session_id_echo = b"\\xa7\\xcd\\xdf0\\x1f\\x06\\x04\\xab\\x0fU\\xebo<\'j\\x03"... (truncated, total 32)\n                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b\'\\x13\\x03\'\n                    legacy_compression_method = b\'\\x00\' (total 1)\n                    extensions = ListContainer: \n                        Container: \n                            extension_type = (enum) supported_versions 43\n                            extension_data = Container: \n                                selected_version = b\'\\x03\\x04\' (total 2)\n                        Container: \n                            extension_type = (enum) key_share 51\n                            extension_data = Container: \n                                server_share = Container: \n                                    group = (enum) x25519 b\'\\x00\\x1d\'\n                                    key_exchange = b\'\\xa50\\xf8\\xe4\\x9a\\xb8\\xebH\\xd4^\\xfb\\xbe/\\x0f>\\x10\'... (truncated, total 32)\n        ephemeral = Container: \n            method = (enum) no_secret 0\n            key = b\'\' (total 0) session_id not found in DB') - Container: 
    designation = (enum) tls13 2
    version = (enum) v1 1
    type = (enum) c_server_hello 10
    status = (enum) request 0
    id = 4556363251079193579
    payload = Container: 
        session_id = b'T7\xdf\xd2' (total 4)
        handshake = ListContainer: 
            Container: 
                msg_type = (enum) server_hello 2
                data = Container: 
                    legacy_version = b'\x03\x03' (total 2)
                    random = b'l\xec\x98\xc3\x0c\xcc\x16\xedBE\xfd(\xcf]\x13\x99'... (truncated, total 32)
                    legacy_session_id_echo = b"\xa7\xcd\xdf0\x1f\x06\x04\xab\x0fU\xebo<'j\x03"... (truncated, total 32)
                    cipher_suite = (enum) TLS_CHACHA20_POLY1305_SHA256 b'\x13\x03'
                    legacy_compression_method = b'\x00' (total 1)
                    extensions = ListContainer: 
                        Container: 
                            extension_type = (enum) supported_versions 43
                            extension_data = Container: 
                                selected_version = b'\x03\x04' (total 2)
                        Container: 
                            extension_type = (enum) key_share 51
                            extension_data = Container: 
                                server_share = Container: 
                                    group = (enum) x25519 b'\x00\x1d'
                                    key_exchange = b'\xa50\xf8\xe4\x9a\xb8\xebH\xd4^\xfb\xbe/\x0f>\x10'... (truncated, total 32)
        ephemeral = Container: 
            method = (enum) no_secret 0
            key = b'' (total 0) session_id not found in DB
[2022-08-03 09:44:52,017 : cs.py:75 -                serve() ] ('invalid_ephemeral', '(EC)DHE not provided (no_secret)but PSK-ECDHE or ECDHE authentication is agreed') - (EC)DHE not provided (no_secret)but PSK-ECDHE or ECDHE authentication is agreed
[2022-08-03 09:44:52,018 : cs.py:75 -                serve() ] ('invalid_ephemeral', '(EC)DHE not provided (no_secret)but PSK-ECDHE or ECDHE authentication is agreed') - (EC)DHE not provided (no_secret)but PSK-ECDHE or ECDHE authentication is agreed
[2022-08-03 09:48:35,832 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1911, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1823, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1726, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1223, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1118, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 09:59:36,713 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1911, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1823, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1726, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1223, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1118, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:04:38,499 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1911, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1823, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1726, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1223, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1118, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:07:36,137 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1911, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1823, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1726, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1223, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1118, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:13:34,857 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1913, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1825, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1728, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1225, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1120, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    print( f"--- append_transcript : build( msg ): { tls.Handshake.build( msg )}" )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:16:37,347 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1915, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1827, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1730, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1227, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1122, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:27:29,877 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1915, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1827, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1730, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1227, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1122, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:50:49,195 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1915, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1827, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1730, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1227, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1122, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 994, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 10:57:42,163 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 11:00:11,182 : cs.py:80 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 11:06:43,844 : cs.py:80 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 11:10:35,355 : cs.py:80 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 65, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 11:16:54,429 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 11:37:51,778 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 11:39:03,850 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 12:04:53,169 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 13:33:01,683 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 13:41:43,945 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 13:43:16,946 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 13:47:25,184 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 13:56:55,756 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 13:58:47,583 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:06:17,643 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:08:51,115 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:10:50,378 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:18:27,216 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:21:57,835 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-03 14:34:06,556 : cs.py:81 -                serve() ] 'server_share'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1718, in __init__
    ephemeral.compute_client_share_secret( client_hello_ephemeral )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 317, in compute_client_share_secret
    client_ks, server_ks = self.get_key_share_entry_list_from_handshake( client_shares=c_init_client_hello_ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 273, in get_key_share_entry_list_from_handshake
    server_ks = ext[ 'extension_data' ][ 'server_share' ]
KeyError: 'server_share'
[2022-08-03 14:35:28,009 : cs.py:81 -                serve() ] 'versions'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1916, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1828, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1731, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1228, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1123, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 995, in append_transcript
    bytes_test_msg = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'versions'
[2022-08-05 13:29:10,421 : cs.py:81 -                serve() ] name 'serialization' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1921, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1838, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1577, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 122, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 263, in compute_client_shares
    encoding=serialization.Encoding.Raw,
NameError: name 'serialization' is not defined
[2022-08-05 14:23:30,057 : cs.py:81 -                serve() ] name 'serialization' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1955, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1872, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1611, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 122, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 264, in compute_client_shares
    encoding=serialization.Encoding.Raw,
NameError: name 'serialization' is not defined
[2022-08-05 14:28:57,464 : cs.py:81 -                serve() ] module 'pylurk.tls13.struct_tls13' has no attribute 'Handshake'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1955, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1872, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1614, in __init__
    self.handshake.update_key_share( self.ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 914, in update_key_share
    bytes_msg = lurk.Handshake.build( self.msg_list[ index ] )
AttributeError: module 'pylurk.tls13.struct_tls13' has no attribute 'Handshake'
[2022-08-05 14:36:27,509 : cs.py:81 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 66, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1279, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1174, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1018, in append_transcript
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:06:57,403 : cs.py:82 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1279, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1174, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1018, in append_transcript
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:16:12,246 : cs.py:82 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1279, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1174, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1018, in append_transcript
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:17:28,136 : cs.py:82 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1279, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1174, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1018, in append_transcript
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:19:40,937 : cs.py:82 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1279, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1174, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1018, in append_transcript
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:25:11,650 : cs.py:82 -                serve() ] name 'TRACE_MODE' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1282, in process
    self.scheduler.client_handshake_traffic_secret( transcript_h )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/key_schedule.py", line 121, in client_handshake_traffic_secret
    if TRACE_MODE is True:
NameError: name 'TRACE_MODE' is not defined
[2022-08-05 15:33:08,634 : cs.py:82 -                serve() ] name 'binascii' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1967, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1879, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1782, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1282, in process
    self.scheduler.client_handshake_traffic_secret( transcript_h )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/key_schedule.py", line 124, in client_handshake_traffic_secret
    print( f"  - shared_secret : {binascii.hexlify( self.handshake_secret, sep=' ')}" )
NameError: name 'binascii' is not defined
[2022-08-05 17:30:47,249 : cs.py:82 -                serve() ] 'KeyScheduler' object has no attribute 'psk'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1973, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1885, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1786, in __init__
    self.scheduler = KeyScheduler( self.handshake.get_tls_hash(), \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1263, in __init__
    self.psk_wrapper = PSKWrapper( self.psk, self.tls_hash, is_ext = is_ext )
AttributeError: 'KeyScheduler' object has no attribute 'psk'
[2022-08-09 13:36:46,459 : cs.py:82 -                serve() ] name 'serialization' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1978, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1895, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1634, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 124, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 263, in compute_client_shares
    private_key, ks_entry = self.proceed_empty_key_share_entry( ks )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 240, in proceed_empty_key_share_entry
    private_key = serialization.load_pem_private_key(\
NameError: name 'serialization' is not defined
[2022-08-09 13:42:45,125 : cs.py:82 -                serve() ] load_pem_private_key() missing 1 required positional argument: 'password'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1980, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1897, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1636, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 126, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 265, in compute_client_shares
    private_key, ks_entry = self.proceed_empty_key_share_entry( ks )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 242, in proceed_empty_key_share_entry
    private_key = serialization.load_pem_private_key(\
TypeError: load_pem_private_key() missing 1 required positional argument: 'password'
[2022-08-11 10:10:44,296 : cs.py:82 -                serve() ] 'data'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1986, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1903, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1645, in __init__
    self.handshake.update_key_share( self.ephemeral.client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 937, in update_key_share
    for k in key_share_ext[ 'data' ][ 'client_shares' ]:
KeyError: 'data'
[2022-08-11 10:40:58,986 : cs.py:82 -                serve() ] 'server_name_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1998, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1910, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1813, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1310, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1197, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1054, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'server_name_list'
[2022-08-11 16:37:10,901 : cs.py:82 -                serve() ] 'server_name_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2000, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1912, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1815, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1312, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1199, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1056, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'server_name_list'
[2022-08-12 09:48:12,673 : cs.py:82 -                serve() ] 'server_name_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2000, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1912, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1815, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1312, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1199, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1056, in append_transcript
    msg_bytes.extend( tls.Handshake.build( msg, **ctx_struct ) )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'server_name_list'
[2022-08-12 09:53:35,280 : cs.py:82 -                serve() ] 'server_name_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1999, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1911, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1814, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1311, in process
    transcript_h = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1198, in transcript_hash
    transcript = self.append_transcript( upper_msg_index )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1057, in append_transcript
    single_msg_bytes = tls.Handshake.build( msg )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2503, in _build
    buildret = self.subcon._build(e, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'server_name_list'
[2022-08-12 17:40:13,677 : cs.py:82 -                serve() ] 'KeyScheduler' object has no attribute 'psk'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2148, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2060, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1961, in __init__
    self.scheduler = KeyScheduler( self.handshake.get_tls_hash(), \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1304, in __init__
    self.psk_wrapper = PSKWrapper( self.psk, self.tls_hash, is_ext = is_ext )
AttributeError: 'KeyScheduler' object has no attribute 'psk'
[2022-08-12 19:46:38,406 : cs.py:82 -                serve() ] __init__() got an unexpected keyword argument 'ecdhe'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2061, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1962, in __init__
    self.scheduler = KeyScheduler( self.handshake.get_tls_hash(), \
TypeError: __init__() got an unexpected keyword argument 'ecdhe'
[2022-08-12 19:49:49,283 : cs.py:82 -                serve() ] 'KeyScheduler' object has no attribute 'hash_len'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2061, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1964, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1429, in process
    self.process_early_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1353, in process_early_secret
    self.psk = b"\x00" * self.hash_len
AttributeError: 'KeyScheduler' object has no attribute 'hash_len'
[2022-08-12 19:50:39,419 : cs.py:82 -                serve() ] name 'HKDF' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2061, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1964, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1429, in process
    self.process_early_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1355, in process_early_secret
    self.early_secret = HKDF(
NameError: name 'HKDF' is not defined
[2022-08-12 20:26:04,821 : cs.py:82 -                serve() ] data must be bytes-like
Traceback (most recent call last):
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/utils.py", line 37, in _check_byteslike
    memoryview(value)
TypeError: memoryview: a bytes-like object is required, not 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2177, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2089, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1992, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1451, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1384, in process_handshake_and_master_secret
    empty_transcript = self.empty_transcript_h( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1376, in empty_transcript_h
    h.update( "" )
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/hazmat/primitives/hashes.py", line 96, in update
    utils._check_byteslike("data", data)
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/utils.py", line 39, in _check_byteslike
    raise TypeError("{} must be bytes-like".format(name))
TypeError: data must be bytes-like
[2022-08-12 20:27:24,012 : cs.py:82 -                serve() ] hkdf_expand_label() got an unexpected keyword argument 'algorithm'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2177, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2089, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1992, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1451, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1389, in process_handshake_and_master_secret
    handshake_secret_salt = self.derive_secret(\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1351, in derive_secret
    return self.hkdf_expand_label( secret=secret, \
TypeError: hkdf_expand_label() got an unexpected keyword argument 'algorithm'
[2022-08-12 20:28:27,272 : cs.py:82 -                serve() ] 'bytes' object has no attribute 'encode'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2177, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2089, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1992, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1451, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1389, in process_handshake_and_master_secret
    handshake_secret_salt = self.derive_secret(\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1351, in derive_secret
    return self.hkdf_expand_label( secret=secret, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1326, in hkdf_expand_label
    tmp_label = b"tls13 " + label.encode()
AttributeError: 'bytes' object has no attribute 'encode'
[2022-08-12 20:32:25,847 : cs.py:82 -                serve() ] name 'backend' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2178, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2090, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1993, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1452, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1399, in process_handshake_and_master_secret
    backend=backend,
NameError: name 'backend' is not defined
[2022-08-12 20:33:09,553 : cs.py:82 -                serve() ] data must be bytes-like
Traceback (most recent call last):
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/utils.py", line 37, in _check_byteslike
    memoryview(value)
TypeError: memoryview: a bytes-like object is required, not 'NoneType'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2178, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2090, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1993, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1452, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1407, in process_handshake_and_master_secret
    self.master_secret = HKDF(
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/hazmat/primitives/kdf/hkdf.py", line 39, in _extract
    h.update(key_material)
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/hazmat/primitives/hmac.py", line 47, in update
    utils._check_byteslike("data", data)
  File "/home/emigdan/.local/lib/python3.8/site-packages/cryptography/utils.py", line 39, in _check_byteslike
    raise TypeError("{} must be bytes-like".format(name))
TypeError: data must be bytes-like
[2022-08-12 20:35:39,563 : cs.py:82 -                serve() ] 'KeyScheduler' object has no attribute 'hanshake_secret'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2178, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2090, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1993, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1465, in process
    s = self.hanshake_secret
AttributeError: 'KeyScheduler' object has no attribute 'hanshake_secret'
[2022-08-12 20:37:22,371 : cs.py:82 -                serve() ] a bytes-like object is required, not 'ListContainer'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2166, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2083, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1822, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 133, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 268, in compute_client_shares
    print_bin( "client_shares", client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 58, in print_bin
    print( f"  - {description} [{len(bit_string)} bytes]: {binascii.hexlify(bit_string, sep=' ')}" )
TypeError: a bytes-like object is required, not 'ListContainer'
[2022-08-12 20:37:52,307 : cs.py:82 -                serve() ] a bytes-like object is required, not 'ListContainer'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2166, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2083, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1822, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 133, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 268, in compute_client_shares
    print_bin( "client_shares", client_shares )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 58, in print_bin
    print( f"  - {description} [{len(bit_string)} bytes]: {binascii.hexlify(bit_string, sep=' ')}" )
TypeError: a bytes-like object is required, not 'ListContainer'
[2022-08-12 20:39:04,163 : cs.py:82 -                serve() ] a bytes-like object is required, not 'str'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2178, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2090, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1993, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1464, in process
    t = handshake.transcript_hash( 'h' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1209, in transcript_hash
    print_bin( "Transcript Hash", transcript_type )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 58, in print_bin
    print( f"  - {description} [{len(bit_string)} bytes]: {binascii.hexlify(bit_string, sep=' ')}" )
TypeError: a bytes-like object is required, not 'str'
[2022-08-12 21:03:53,629 : cs.py:82 -                serve() ] __init__() missing 1 required positional argument: 'info'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2187, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2099, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2002, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1454, in process
    self.process_early_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1363, in process_early_secret
    self.early_secret = HKDF(
TypeError: __init__() missing 1 required positional argument: 'info'
[2022-08-12 21:20:42,409 : cs.py:82 -                serve() ] 'bytes' object has no attribute 'encode'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2193, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2105, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2008, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1456, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1390, in process_handshake_and_master_secret
    handshake_secret_salt = self.derive_secret(\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1352, in derive_secret
    return self.hkdf_expand_label( secret=secret, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1337, in hkdf_expand_label
    'label' : b"tls13 " + label.encode(), \
AttributeError: 'bytes' object has no attribute 'encode'
[2022-08-15 16:46:52,048 : cs.py:82 -                serve() ] name 'sel' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2249, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2161, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2062, in __init__
    self.scheduler = KeyScheduler( self.handshake.get_tls_hash(), \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1032, in get_tls_hash
    return CipherSuite( self.get_cipher_suite() ).get_hash()
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/conf.py", line 215, in __init__
    sel.tag_len = self. tag_length( )
NameError: name 'sel' is not defined
[2022-08-15 16:47:37,914 : cs.py:82 -                serve() ] 'CipherSuite' object has no attribute 'mode'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2249, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2161, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2062, in __init__
    self.scheduler = KeyScheduler( self.handshake.get_tls_hash(), \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1032, in get_tls_hash
    return CipherSuite( self.get_cipher_suite() ).get_hash()
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/conf.py", line 218, in __init__
    self.mode = self.mode()
AttributeError: 'CipherSuite' object has no attribute 'mode'
[2022-08-15 17:28:39,856 : cs.py:82 -                serve() ] name 'binascii' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2237, in payload_resp
    payload  = session.serve( req_payload, req_type, 'request')
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2154, in serve
    req = CInitClientHelloReq( payload, self.conf )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1893, in __init__
    self.ephemeral = Ephemeral( { 'method' : 'cs_generated' }, self.mtype, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 133, in __init__
    self.client_shares, self.private_key_list, self.resp = self.compute_client_shares( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 291, in compute_client_shares
    pylurk.utils.print_bin( "private_key", private_key_bytes )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/utils.py", line 5, in print_bin
    print( f"  - {description} [{len(bit_string)} bytes]: {binascii.hexlify(bit_string, sep=' ')}" )
NameError: name 'binascii' is not defined
[2022-08-22 14:54:46,005 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:10:59,989 : cs.py:82 -                serve() ] 'NoneType' object is not iterable
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2289, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2206, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2120, in __init__
    self.handshake.msg_list.extend( req[ 'handshake' ] )
TypeError: 'NoneType' object is not iterable
[2022-08-22 15:11:38,663 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:17:07,370 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:17:50,144 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:18:43,140 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:19:26,752 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:24:52,837 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:25:37,748 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 15:26:43,477 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:32:36,083 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:33:34,939 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:34:35,609 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:35:16,964 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:36:10,348 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:37:47,408 : cs.py:77 -                serve() ] ('invalid_handshake', "unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]") - unexpected handshake [EnumIntegerString.new(8, 'encrypted_extensions'), EnumIntegerString.new(15, 'certificate_verify'), EnumIntegerString.new(20, 'finished')]
[2022-08-22 19:38:47,806 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2299, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2216, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in __init__
    self.handshake.update_certificate_verify( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 990, in update_certificate_verify
    transcript_h = self.transcript_hash( 'sig' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1168, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ]for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ]for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 19:42:37,743 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2300, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2217, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2150, in __init__
    self.handshake.update_certificate_verify( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 991, in update_certificate_verify
    transcript_h = self.transcript_hash( 'sig' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1169, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 679, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 679, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 19:43:28,350 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2299, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2216, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in __init__
    self.handshake.update_certificate_verify( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 990, in update_certificate_verify
    transcript_h = self.transcript_hash( 'sig' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1168, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 19:47:19,248 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2299, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2216, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2149, in __init__
    self.handshake.update_certificate_verify( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 990, in update_certificate_verify
    transcript_h = self.transcript_hash( 'sig' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1168, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 19:59:44,791 : cs.py:82 -                serve() ] 'CClientFinishedReq' object has no attribute 'is_certificate_request'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2304, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2221, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2126, in __init__
    is_cert_req = self.is_certificate_request()
AttributeError: 'CClientFinishedReq' object has no attribute 'is_certificate_request'
[2022-08-22 20:11:06,293 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2304, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2221, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2159, in __init__
    self.handshake.update_server_finished( self.scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1035, in update_server_finished
    self.update_finished( scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1042, in update_finished
    verify_data = self.get_verify_data( scheduler, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1017, in get_verify_data
    hmac.update( self.transcript_hash( transcript_mode ) )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1204, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 20:17:13,676 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2305, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2222, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2160, in __init__
    self.handshake.update_server_finished( self.scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1035, in update_server_finished
    self.update_finished( scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1042, in update_finished
    verify_data = self.get_verify_data( scheduler, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1017, in get_verify_data
    hmac.update( self.transcript_hash( transcript_mode ) )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1204, in transcript_hash
    print( f" --- self.msg_type_list( ): {self.msg_type_list( )}" )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 20:18:44,319 : cs.py:82 -                serve() ] 'msg_type'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2305, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2222, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2160, in __init__
    self.handshake.update_server_finished( self.scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1035, in update_server_finished
    self.update_finished( scheduler )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1042, in update_finished
    verify_data = self.get_verify_data( scheduler, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1017, in get_verify_data
    hmac.update( self.transcript_hash( transcript_mode ) )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1205, in transcript_hash
    if self.msg_type_list( ) not in [ \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in msg_type_list
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 678, in <listcomp>
    return [ msg[ 'msg_type' ] for msg in self.msg_list ]
KeyError: 'msg_type'
[2022-08-22 20:20:55,540 : cs.py:82 -                serve() ] can't concat str to bytes
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2305, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2222, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2161, in __init__
    self.scheduler.process( [ 'r' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1541, in process
    self.secrets[ 'r' ] = self.derive_secret( s, "exp master", t )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1381, in derive_secret
    return self.hkdf_expand_label( secret=secret, \
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1366, in hkdf_expand_label
    'label' : b"tls13 " + label, \
TypeError: can't concat str to bytes
[2022-08-22 20:26:16,643 : cs.py:82 -                serve() ] 'secret_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 73, in serve
    return LURKMessage.build( resp )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'secret_list'
[2022-08-22 20:28:22,405 : cs.py:83 -                serve() ] 'secret_list'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 74, in serve
    return LURKMessage.build( resp )
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 336, in build
    self.build_stream(obj, stream, **contextkw)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 348, in build_stream
    self._build(obj, stream, context, "(building)")
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2144, in _build
    buildret = sc._build(subobj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2657, in _build
    return self.subcon._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 4715, in _build
    buildret = self.subcon._build(obj, stream2, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 3924, in _build
    return sc._build(obj, stream, context, path)
  File "/home/emigdan/.local/lib/python3.8/site-packages/construct/core.py", line 2139, in _build
    subobj = obj[sc.name] # raises KeyError
KeyError: 'secret_list'
[2022-08-22 20:55:28,336 : cs.py:83 -                serve() ] name 'secret_request' is not defined
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2315, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2232, in serve
    req = CClientFinishedReq( payload, self.conf, self.handshake, self.scheduler,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2174, in __init__
    'secret_list' : secret_request.resp( self.scheduler ) }
NameError: name 'secret_request' is not defined
[2022-08-23 08:41:43,814 : cs.py:83 -                serve() ] 'KeyScheduler' object has no attribute 'hash_len'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2309, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2221, in serve
    req = CServerHelloReq( payload, self.conf, self.handshake, self.ephemeral,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2113, in __init__
    self.scheduler.process( [ 'h_c', 'h_s' ], self.handshake )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1490, in process
    self.process_handshake_and_master_secret( )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 1446, in process_handshake_and_master_secret
    length=self.tls_hash.digest_size )._extract( b"\x00" * self.hash_len )
AttributeError: 'KeyScheduler' object has no attribute 'hash_len'
[2022-08-23 20:14:04,890 : cs.py:83 -                serve() ] 'SHA384' object has no attribute 'hkdf_expand_label'
Traceback (most recent call last):
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/cs.py", line 67, in serve
    payload = self.tls13.payload_resp( req )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2309, in payload_resp
    payload = session.serve( req_payload, req_type, 'request' )
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2238, in serve
    req = CRegisterTicketsReq( payload, self.conf, self.ticket_db,\
  File "/home/emigdan/gitlab/pylurk.git/src/pylurk/tls13/lurk_tls13.py", line 2185, in __init__
    psk = tls_hash.hkdf_expand_label( transcript_r, b"resumption", \
AttributeError: 'SHA384' object has no attribute 'hkdf_expand_label'
